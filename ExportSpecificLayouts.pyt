# -*- coding: utf-8 -*-import arcpyclass Toolbox:    def __init__(self):        """Define the toolbox (the name of the toolbox is the name of the        .pyt file)."""        self.label = "Toolbox"        self.alias = "toolbox"        # List of tool classes associated with this toolbox        self.tools = [Tool]class Tool:    def __init__(self):        """Define the tool (tool name is the name of the class)."""        self.label = "Export Specific Layouts"        self.description = ""    def getParameterInfo(self):        """Define the tool parameters."""        input1 = arcpy.Parameter(            displayName="Layout List",            name="layoutList",            datatype="Layout",               parameterType="Required",            direction="Input")        input1.multiValue = True                input2 = arcpy.Parameter(            displayName="File Type",            name="exportFormat",            datatype="String",            parameterType="Required",            direction="Input")        input2.filter.type = "ValueList"        input2.filter.list = ["PNG", "JPG", "PDF", "AIX"]        input3 = arcpy.Parameter(            displayName="Resolution",            name="exportRes",            datatype="Long",            parameterType="Required",            direction="Input")        input3.value = 350        input4 = arcpy.Parameter(            displayName="Output Folder",            name="figFolder",            datatype="Folder",            parameterType="Required",            direction="Input")                params = [input1, input2, input3, input4]        return params    def isLicensed(self):        """Set whether the tool is licensed to execute."""        return True    def updateParameters(self, parameters):        """Modify the values and properties of parameters before internal        validation is performed.  This method is called whenever a parameter        has been changed."""        return    def updateMessages(self, parameters):        """Modify the messages created by internal validation for each tool        parameter. This method is called after internal validation."""        return    def execute(self, params, messages):        import arcpy        import os        # Get the current project        aprx = arcpy.mp.ArcGISProject("CURRENT")        # Get parameters from the tool        layoutList = params[0].valueAsText        exportFormat = params[1].valueAsText        exportRes = int(params[2].value)        figFolder = params[3].valueAsText        # Make sure the output folder ends with a path separator        if not figFolder.endswith(os.sep):            figFolder += os.sep        # Validate export format        valid_export_formats = ['png', 'jpg', 'pdf', 'aix']        if exportFormat.lower() not in valid_export_formats:            arcpy.AddError(f"Invalid export format: {exportFormat}")            return        # Split the user input into a list        selected_layouts = layoutList.split(';')        # Strip any leading or trailing spaces from the layout names and create a set        selected_layouts = {layout.strip() for layout in selected_layouts if layout.strip()}        # Debug: print selected layouts        arcpy.AddMessage(f"Selected layouts: {selected_layouts}")        # Iterate through all layouts in the project        for lyt in aprx.listLayouts():            if lyt.name in selected_layouts:                safe_name = lyt.name.replace(" ", "_").replace("/", "-")                outputFilePath = os.path.join(figFolder, f"{safe_name}.{exportFormat.lower()}")                        # Determine the export function based on the chosen format                try:                    if exportFormat.lower() == "png":                        lyt.exportToPNG(outputFilePath, resolution=int(exportRes))                        arcpy.AddMessage(f"Exported {lyt.name} to {outputFilePath}")                    elif exportFormat.lower() == "jpg":                        lyt.exportToJPEG(outputFilePath, resolution=int(exportRes))                        arcpy.AddMessage(f"Exported {lyt.name} to {outputFilePath}")                    elif exportFormat.lower() == "pdf":                        lyt.exportToPDF(outputFilePath, resolution=int(exportRes))                        arcpy.AddMessage(f"Exported {lyt.name} to {outputFilePath}")                    elif exportFormat.lower() == "aix":                        lyt.exportToAIX(outputFilePath, resolution=int(exportRes))                        arcpy.AddMessage(f"Exported {lyt.name} to {outputFilePath}")                except Exception as e:                        arcpy.AddError(f"Failed to export {lyt.name} to {outputFilePath}: {str(e)}")        return    def postExecute(self, parameters):        """This method takes place after outputs are processed and        added to the display."""        return